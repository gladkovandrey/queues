# Kafka Streams Processing - –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ 3

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –±–∞–∑–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ Kafka –∫–ª–∞—Å—Ç–µ—Ä–∞.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
application-logs (–∏—Å—Ö–æ–¥–Ω—ã–µ –ª–æ–≥–∏)
    ‚Üì
[Mapper] ‚Üí error-logs (—Ç–æ–ª—å–∫–æ ERROR –ª–æ–≥–∏)
    ‚Üì
[Aggregator] ‚Üí error-stats (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º)

service-metrics (–º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
    ‚Üì
error-logs + service-metrics ‚Üí [Join Processor] ‚Üí enriched-errors (–æ—à–∏–±–∫–∏ + –º–µ—Ç—Ä–∏–∫–∏)
```

## üì¶ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **mapper/** - —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç ERROR –ª–æ–≥–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç
- **aggregator/** - –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º –∑–∞ 1-–º–∏–Ω—É—Ç–Ω—ã–µ –æ–∫–Ω–∞
- **join-processor/** - –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –æ—à–∏–±–∫–∏ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ 
- **metrics-producer/** - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (CPU, –ø–∞–º—è—Ç—å, latency)
- **stats-consumer/** - —á–∏—Ç–∞–µ—Ç –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ—à–∏–±–æ–∫
- **enriched-consumer/** - —á–∏—Ç–∞–µ—Ç –æ–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫

## üöÄ –ó–∞–ø—É—Å–∫

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π Kafka –∫–ª–∞—Å—Ç–µ—Ä:**
```bash
cd ..
./start-kafka.sh
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–∞–∑–æ–≤—ã–µ producer/consumer:**
```bash
cd ..
./scale-apps.sh
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å Stream Processing –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
```bash
docker compose -f docker-compose.streams.yml up -d
```

4. **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫: `docker compose -f docker-compose.streams.yml logs -f stats-consumer`
- –û–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏: `docker compose -f docker-compose.streams.yml logs -f enriched-consumer`
- Kafka UI: http://localhost:8180

## üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
docker compose -f docker-compose.streams.yml down
cd ..
./stop-all.sh
```

## üìä –¢–æ–ø–∏–∫–∏

- `application-logs` - –∏—Å—Ö–æ–¥–Ω—ã–µ –ª–æ–≥–∏ (–∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞)
- `error-logs` - –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ ERROR –ª–æ–≥–∏
- `service-metrics` - –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤  
- `error-stats` - –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫
- `enriched-errors` - –æ—à–∏–±–∫–∏, –æ–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∞–º–∏

## üîç –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

1. **Mapper** —á–∏—Ç–∞–µ—Ç –∏–∑ `application-logs`, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ ERROR –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ `error-logs`
2. **Aggregator** —á–∏—Ç–∞–µ—Ç –∏–∑ `error-logs`, —Å—á–∏—Ç–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ `error-stats`
3. **Metrics Producer** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ `service-metrics`
4. **Join Processor** –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç `error-logs` + `service-metrics` ‚Üí `enriched-errors`
5. **Consumers** —á–∏—Ç–∞—é—Ç –∏ –∫—Ä–∞—Å–∏–≤–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã 